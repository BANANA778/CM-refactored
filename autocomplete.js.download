 "use strict";
/*globals YAHOO, STN*/

(function () {
	var loaded = function () {
		var dataSource, moduleDataSource, keyword, YUSQ = YAHOO.util.Selector.query;
		dataSource = new YAHOO.util.XHRDataSource(STN.live_site + "/components/com_virtuemart/autocomplete.php");
		dataSource.responseType = YAHOO.util.XHRDataSource.TYPE_TEXT;
		dataSource.maxCacheEntries = 5;	
		dataSource.responseSchema = {
			recordDelim: "\n",
			fieldDelim: "\t"
		};
		
		moduleDataSource = new YAHOO.util.XHRDataSource(STN.live_site + "/components/com_virtuemart/autocomplete.php");
		moduleDataSource.responseType = YAHOO.util.XHRDataSource.TYPE_TEXT;
		moduleDataSource.maxCacheEntries = 5;	
		moduleDataSource.responseSchema = {
			recordDelim: "\n",
			fieldDelim: "\t"
		};
		
		keyword = YUSQ('.stn-keyword-taken')[0];
		
		STN.filterAutoComplete = new YAHOO.widget.AutoComplete("autocomplete-input", "autocomplete-box", dataSource);
		STN.moduleAutoComplete = new YAHOO.widget.AutoComplete(keyword, "quicksearch-box", moduleDataSource);
		
		STN.filterAutoComplete.autoHighlight = false;
		STN.moduleAutoComplete.autoHighlight = false;
	};
	
	YAHOO.util.Event.onDOMReady(function () {
		var loader = new YAHOO.util.YUILoader({
			require: ["autocomplete", "connectioncore", "datasource", "selector"],
			combine: false,
			onSuccess: loaded,
			timeout: 10000,
			base: STN.live_site + "/yui/",
			skin: {
				base: 'assets/skins/',
				defaultSkin: 'sam'
			}
		});
	
		loader.insert();
	});
}());


